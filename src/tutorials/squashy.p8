pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
-- Pico 8 tutorial "SQUASHY" from the pico 8 fanzine issue 1
score = 0
lives = 3

-- Paddle
padX = 52
padY = 122
padW = 24
padH = 4

-- Ball
ballX = 64
ballY = 64
ballSize = 3
ballXDir = 3
ballYDir = -3

-- Buttons: left right up down C X
function movePaddle()
    if btn(0) then
        padX -= 3
    elseif btn(1) then
        padX += 3
    end
end

function moveBall()
    ballX += ballXDir
    ballY += ballYDir
end

function loseDeadBall()
    if ballY > 128 then
        if lives > 0 then
            -- Next life
            sfx(3)
            ballY = 24
            lives -= 1
        else
            -- Game Over
            sfx(1)
            ballXDir = 0
            ballYDir = 0
            ballY = 64
        end
    end
end

function bounceBall()
    -- Left
    if ballX < ballSize then
        ballXDir = -ballXDir
        sfx(0)
    end

    -- Right
    if ballX > 128 - ballSize then
        ballXDir = -ballXDir
        sfx(0)
    end

    -- Top
    if ballY < ballSize then
        ballYDir = -ballYDir
        sfx(0)
    end
end

function bouncePaddle()
    if ballX >= padX and
        ballX <= padX + padW and
        ballY > padY then
        score += 10
        ballYDir = -ballYDir
        sfx(0)
    end
end

-- Special game callbacks

function _update()
    movePaddle()
    bounceBall()
    bouncePaddle()
    moveBall()
    loseDeadBall()
end

function _draw()
    -- Clear the screen
    rectfill(0,0,128,128,black)

    -- Draw lives
    for i=1,lives do
        spr(001,90 + i * 8,4)
    end

    -- Draw the score
    print(score,12,6,15)
    

    -- Draw the paddle
    rectfill(padX,padY,padX+padW,padY+padH,15)

    -- Draw the ball
    circfill(ballX, ballY, ballSize, 15)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000088088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000088888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000400002c07000000000000000000000000000000000000360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001d0000110500b050050500505005050050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000002f07028070210701a070140700f0700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
